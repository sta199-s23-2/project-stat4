---
title: "Food Access in different Regions"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

```{r}
library (tidyverse)
library(tidymodels)
UNICEF_Food <- read.csv("data/UNICEF_Expanded_Global_Databases_FINAL.csv")
food_access <- read.csv("data/food_access.csv")
slice_head (UNICEF_Food)
```

**Introduction and data**

The source of the dataset is from the United Nations Children's Fund, Division of Data, Analysis, Planning and Monitoring (2022). The dataset includes global statistics on the percentage of children 6-23 months of age who did not consume any fruits and vegetables over the previous day. This dataset originates from October, 2022.

The issue of insufficient fruits and vegetables available in the world traces back decades. According to "Insufficient Consumption of Fruits and Vegetables among Individuals 15 Years and Older in 28 Low- and Middle-Income Countries: What Can Be Done?" Karen S Siegal, expresses that only roughly 20% of those in low and middle income countries are meeting the daily fruit and vegetable average. We want to explore this topic further given how prevalent an issue it is in the world..

Each observation represents three-digit alphabetical codes ISO assigned by the International Organization for Standardization (columns also detail countries, UNICEF regions, UN regions, world bank income group, data source years, and the way that the survey was collected). Previous studies have shown that children from low and low-middle countries had the lowest consumption of fruits and vegetables. Globally, zero vegetable or fruit consumption is very high with 46% of children in the dataset consuming no vegetables or fruit the day before the survey. We will be exploring this concept more with the UNICEF data.

The observations come from qualitative, survey samples from 2015 to 2021.

**Methodology**

Collected through surveys (national/nutrition monitoring and surveillance systems/multiple indicator cluster survey) from 2015 to 2021 and countries with data from this period are included in calculation of regional and global averages with the exception of China where the latest data are from 2013.

We will be using r functions to create graphs to analyze the data and find linear regression for different factors like using parent income, parent education, and wealth quantile.

Using this data, we hope to develop an inference to predict if lower or higher incomes have lower or higher consumption of fruits and vegetables for children.

**Results**

Are there greater gender differences in the consumption of zero vegetable or fruit for low income countries than in higher income countries?

We hypothesize that there are male infants are better fed than female infants in lower-income countries whereas this gender gap is less prevalent in upper-middle income countries. The variables involved in our research question are numerical, with the indicator being the percentage of children 6-23 months of age who did not consume any vegetables or fruits during the previous day.

We hypothesize that there are male infants are better fed than female infants in lower-income countries whereas this gender gap is less prevalent in upper-middle income countries. The variables involved in our research question are numerical, with the indicator being the percentage of children 6-23 months of age who did not consume any vegetables or fruits during the previous day.

```{r}
UNICEF_Food |>
  group_by(WB_Latest) |>
  summarise(mean_male = mean(male_r, na.rm = T), 
            mean_female = mean(female_r, na.rm = T))
```

There seems to be a significant difference between female and male consumption of vegetables and fruit based on the previous day depending on the income categorization of their country. Around 14% of males in the high income category did not consume vegetables or fruit in the previous day. Around 24% of females in the high income category did not consume any vegetables or fruit in the previous day.

```{r}
UNICEF_Food |>
  filter(WB_Latest == "Low Income") |>
  summarise(mean_urban = mean(urban_r, na.rm = T), 
            mean_rural = mean(rural_r, na.rm = T))
```

In low income countries, mean percentage of individuals who did not consume any vegetables or fruit the previous day is higher for rural areas as compared to in urban areas.

```{r}
UNICEF_Food |>
  filter(WB_Latest == "Low Income") |>
  summarise(mean_6to11 = mean(month_6_11_r),
            mean_12to15 = mean(month_12_15_r), 
            mean_16to19 = mean(month_16_19_r))
```

In low-income countries, there appears to be a correlation between age and vegetable and fruit consumption, with younger individuals (months 6-11) having the highest mean percentage of not consuming fruit/vegetable in the previous day. For older individuals, the mean percentage is smaller.

```{r}
UNICEF_Food |>
  filter(WB_Latest == "High Income") |>
  summarise(mean_6to11 = mean(month_6_11_r, na.rm = T),
            mean_12to15 = mean(month_12_15_r, na.rm = T), 
            mean_16to19 = mean(month_16_19_r, na.rm = T))
```

In high income countries, age does not seem to play as an important factor in consumption of fruit/vegetables as it does in lower income countries. There also does not appear to be any correlation between age and fruit/vegetable consumption.

```{r}
UNICEF_Food |>
  filter (WB_Latest !="") |>
  ggplot(aes(x = UNRegion, fill = WB_Latest, na.rm = T)) + 
  geom_bar() + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Regions (UN)",
       Y = "People Surveyed",
       fill = "Income Level",
       title = "Regions by Income Level")
```

It is important to consider the confounding variable of different levels of average income in regions of the world. For example, Asia's minimum wage on average may be way lower than the United States, yet that minimum wage is sustainable to live on there. We graphed the region versus income level above. From this graph, we can see that Africa has much more low-income people than any other country, Asia has the majority of people in lower middle income, Oceania has less people in the data on average and may not be completely representative of the trends for Oceania. Europe is largely upper middle income. While Asia has more people in lower middle income than upper, it is important to consider that most groceries there especially in rural areas are at a much lower price.

**Are there greater gender differences in the consumption of zero vegetable or fruit for low income countries than in higher income countries?**

**Null Hypothesis: There is no difference between the true mean males consumption of fruit in low income countries for females for the consumption of fruit in low income countries**

**Alternative Hypothesis: The true mean of boy's consumption of zero vegetables or fruit in low income is less than the true mean of girl's consumption of zero vegetables or fruit**\
$H_o: \pi_m = \pi_f$

$H_a: \pi_m < \pi_f$

```{r}

#set.seed(777)

#UNICEF_Food |>
  #mutate(WB_Latest = factor(WB_Latest))

#logistic_reg() |>
  #set_engine("glm") |>
  #fit(WB_Latest ~ male_r, data = UNICEF_Food, family = "binomial")


```

\

```{r}
food_access<- food_access |>
  mutate(percentage = Vehicle.Access.1.Mile/Housing.Data.Total.Housing.Units) 


food_access |>
  group_by(State) |>
  summarise(mean = mean(percentage))

#food_access|>
  #mutate(region = if_else(state == c("New Mexico", "Oklahoma", "Texas", "Arizona", "Virginia", "West Virginia", "Kentucky", "Tennessee", "North Carolina", "South Carolina", "Georgia", "Florida", "Alabama", "Mississippi", "Louisiana", "Arkansas") , "South")))
```

```{r}
food_access <- food_access |>
  mutate()
```

```{r}
library(readr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(tidymodels)

# Read in the data
food_access <- read_csv("data/food_access.csv")

# Rename the Housing Data.Residing in Group Quarters column
food_access <- food_access %>% rename(group_quarters = `Housing Data.Residing in Group Quarters`)

# Create a scatterplot to visualize the relationship between the two variables
ggplot(data = food_access, aes(x = group_quarters, y = `Vehicle Access.1 Mile`)) +
  geom_point() +
  labs(x = "Percentage of Population Residing in Group Quarters", y = "Number of Housing Units without Vehicle Access Beyond 1 Mile from a Supermarket") +
  ggtitle("Relationship between Group Quarters and Housing Units without Vehicle Access") 

# Perform a linear regression to quantify the relationship

  
  
model1 <- linear_reg() |>
  set_engine("lm") |>
  fit(`Vehicle Access.1 Mile` ~ group_quarters , data = food_access)

model1 |>
  glance() |>
  pull(adj.r.squared)

```

the adjusted R-squared value of 0.43 suggests that the predictor variable "Vehicle Access.1 Mile" accounts for approximately 43% of the variability in the response variable "group_quarters", after adjusting for the effect of other predictor variables in the model.

This means that there is a moderate positive linear relationship between the percentage of housing units without vehicle access beyond 1 mile from a supermarket (as represented by the predictor variable "Vehicle Access.1 Mile") and the percentage of tract population residing in group quarters (as represented by the response variable "group_quarters").

```{r}

summary(food_access[,c("Population", "group_quarters", "Housing Data.Total Housing Units", "Vehicle Access.1 Mile")])

# Check for missing values
sum(is.na(food_access))

ggplot(food_access, aes(x= group_quarters)) +
  geom_histogram(binwidth=10, fill="blue", color="white") +
  labs(title="Distribution of population residing in group quarters", x="Population in group quarters", y="Frequency")

ggplot(food_access, aes(x=`Vehicle Access.1 Mile`, y= group_quarters)) +
  geom_point() +
  labs(title="Scatterplot of vehicle access beyond 1 mile against population in group quarters", x="Vehicle Access.1 Mile", y="Population in group quarters")
```

```{r}
food_access |>
  group_by(State) |>
  summarise(total = mean(group_quarters)) 


```

district of columbia has the most living in group quarters

```{r}
food_access |>
  filter(State == "District of Columbia") |>
  ggplot(aes(x = group_quarters, y = `Vehicle Access.1 Mile`)) +
  geom_point() +
  geom_smooth(method = "lm" , se = F) 
```

```{r}
food_access_DC <- food_access |>
  filter(State == "District of Columbia")

linear_reg() |>
  set_engine("lm") |>
  fit(`Low Access Numbers.Low Income People.1 Mile` ~ `Vehicle Access.1 Mile` + `Low Access Numbers.Seniors.1 Mile`, data = food_access_DC) |>
  tidy()
```

```{r}
food_access_ND <- food_access |>
  filter(State == "North Dakota")

model_ND <- linear_reg() |>
  set_engine("lm") |>
  fit(`Low Access Numbers.Low Income People.1 Mile` ~ `Vehicle Access.1 Mile` + `Low Access Numbers.Seniors.1 Mile`, data = food_access_ND) 

model_ND |>
  glance() |>
  pull(adj.r.squared)
```

REALLY GOOD MODEL, has high adjusted r squared value,

use

```{r}
food_access$DC <- ifelse(food_access$State == "District of Columbia", 1, 0)

food_access2 <- food_access %>% select(-c(County, State))

model <- glm(DC ~ ., data = food_access2, family = "binomial")


#prob <- predict(model, type = "response")
#roc_obj <- roc(food_access2
               #$DC, prob)
#auc(roc_obj)
```
