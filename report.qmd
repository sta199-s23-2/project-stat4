---
title: "Food Access in different Regions"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: false
---

## Introduction and Data

We are interested in the topic of food accessibility (defined as the ability to access healthy and affordable foods) in the US and how factors such as family income, vehicle availability, and neighborhood characteristics such as average income and availability of public transportation impact food accessibility. Our data is from the United States Department of Agriculture's Economic Research Service, which contains information about US county's ability to access supermarkets. Though there is no available information on how the USDA ERS collected this particular dataset, the USDA ERS generally collects data in the following ways: surveys, administrative data, census data, and remote sensing. Given the variables of the food access data, it is likely that the USDA ERS used a combination of surveys and census data to collect information.

Definitions of Key Variables: County: County Name Population: Population Count from 2010 Census State: State Name Housing Data. Total Housing Units: Occupied Housing Unit Count from 2010 Census Vehicle Access. 10 Miles: Housing Units without Vehicle Count Beyond 10 Miles from Supermarket Low Access Numbers.Low Income People. 10 Miles: Low income population count beyond 10 miles from supermarket Low Access Numbers.People.10 Miles: Population count beyond 10 miles from supermarket Low.Access Numbers.Seniors.10 Miles: Seniors population count beyond 10 miles from supermarket

Research Question: Is the Midwest more impacted by being low income and being beyond 10 miles from a supermarket compared to the Northeast? If there is a difference between those two regions, what variables contribute to that?

Given our background research on the Midwest and the Northeast regions, we hypothesize that the Midwest will be mostly impacted by having a greater proportion of low income population count beyond 10 miles from supermarkets. We will conduct a hypothesis test to test this hypothesis.

What is the confidence interval for the true mean proportion of low income individuals that live beyond 10 miles from a supermarket in the Northeast? In the Midwest?

Data cleaning: We first mutated the dataset to categorize each state into their respective region (Midwest, Northeast, Southwest, Southeast, and West).

## Literature Review

https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6369228/

This study examines the relationship between access to a personal vehicle and diet, food insecurity, and physical activity among public housing residents, which are typically low-income, urban populations. The study conducted a cross-sectional survey of randomly selected households within two public housing communities in Baltimore, MD. The study used Poisson regression with robust error variance to estimate relative risk ratios adjusted for demographics and perceived environmental factors.

The independent variable was whether or not the resident had access to a personal vehicle which the dependent variables were 'high' fruit & vegetable intake (= 6.7 servings/day), 'high' added sugar intake (+ 39.9 tsp/day), food insecurity, and being physically active. The sample included 265 adults with mean age of 45 years, 86% women, and 96% African-American. Only 42% had access to a vehicle.

The study found that there were no significant associations that existed between personal vehicle access with diet or physical activity outcomes. However, the study found that access to a personal vehicle was associated with significantly lower risk of food insecurity (RR 0.76, 95% CI 0.63-0.92, p \< 0.01). There was a significant association between personal vehicle access and lower risk of food insecurity.

In connection to the article, our research explores other factors beyond transportation (specifically vehicle access) such as family income, age, and availability of public transportation. Our research also expands across both urban and rural areas in the United States while the article focuses exclusively on Baltimore, MD. Our research is important because it will address if more factors impact food access for low income individuals.

## Methodology

First, in order to clean our data and prep for the data analysis and models, different region vectors were created in order to merge with the original food_access datasets. Since our research question involves regions and the original datasets does not include that, multiple mutate with case_when was used to clean and modify the data.

In order to explore the basic relationships, first some exploratory data analysis was conducted to see which specific states in the regions our research question was exploring. By quantifying and visualizing the relationship between the variables in the Midwest and Northeast, the sample mean difference is extracted from the given regions. This is used to run a hypothesis test in order to answer our research question. With a null distribution and p-value either reject or fail to reject the null hypothesis of no difference between the two regions. This would help answer our research question as it would show which region is impacted more by taking the mean of the proportions of low income people 10 miles away from the supermarket without a vehicle. Based on the results of the hypothesis test, we run a confidence interval in order to see where the true mean lies in each region.

In order to find which variables contribute to the Midwest region being more impacted by low income and no transportation a linear regression model is used as the low income people without vehicle access beyond 10 miles from a supermarket is the explanatory, and the number of people living in housing quarters as the response variable. This would be the best variable to use in the linear regression because the other data refers to children, seniors, and other varying amounts of vehicle distance. Therefore, housing group quarters population would be the best variable to use in this linear regression model and would help solidify the second part of the research question.Â 

```{r}

#| label: read libraries

library(readr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(tidymodels)

food_access <- read_csv("data/food_access.csv")
glimpse(food_access)

```

```{r}

#| label: creating proportions and mutating data

Midwest <- c("Ohio", "Indiana", "Michigan", "Illinois", "Missouri", "Wisconsin", "Minnesota", "Iowa", "Kansas", "Nebraska", "South Dakota", "North Dakota")

Northeast <- c ("Maine", "Massachusetts", "Rhode Island", "Connecticut", "New Hampshire", "Vermont", "New York", "Pennsylvania", "New Jersey", "Delaware", "Maryland", "District of Columbia")

Southwest <- c ("Texas", "Oklahoma", "New Mexico", "Arizona")

Southeast <- c ("West Virginia", "Virginia", "Kentucky", "Tennessee", "North Carolina", "South Carolina", "Georgia", "Alabama", "Mississippi", "Arkansas", "Louisiana", "Florida")

West <- c("Colorado", "Wyoming", "Montana", "Idaho", "Washington", "Oregon", "Utah", "Nevada", "California", "Alaska", "Hawaii")

food_access_reg <- food_access |>
  mutate (region = case_when(State %in% Northeast ~ "Northeast", State %in% Southeast ~ "Southeast", State %in% Midwest ~ "Midwest", State %in% Southwest ~ "Southwest", State %in% West ~ "West")) 

food_access_reg <-food_access_reg |>
  mutate (proportion = `Low Access Numbers.Low Income People.10 Miles` / `Housing Data.Total Housing Units`, proportion_vechicle = `Low Access Numbers.Low Income People.10 Miles`, proportion_vehicle = `Vehicle Access.10 Miles`/`Housing Data.Total Housing Units`, proportion_seniors = `Low Access Numbers.Seniors.10 Miles`/`Housing Data.Total Housing Units`, proportion_group = `Housing Data.Residing in Group Quarters`/`Housing Data.Total Housing Units`)

```

```{r}

#| label: creating new column

food_access <- food_access %>% rename(group_quarters = `Housing Data.Residing in Group Quarters`)

# Create a scatterplot to visualize the relationship between the two variables
ggplot(data = food_access, aes(x = group_quarters, y = `Vehicle Access.1 Mile`)) +
  geom_point() +
  labs(x = "Percentage of Population Residing in Group Quarters", y = "Number of Housing Units without Vehicle Access Beyond 1 Mile from a Supermarket") +
  ggtitle("Relationship between Group Quarters and Housing Units without Vehicle Access") 

# Perform a linear regression to quantify the relationship
model1 <- linear_reg() |>
  set_engine("lm") |>
  fit(`Vehicle Access.1 Mile` ~ group_quarters , data = food_access)

model1 |>
  glance() |>
  pull(adj.r.squared)

```

The adjusted R-squared value of 0.43 suggests that the predictor variable "Vehicle Access.1 Mile" accounts for approximately 43% of the variability in the response variable "group_quarters", after adjusting for the effect of other predictor variables in the model.

This means that there is a moderate positive linear relationship between the percentage of housing units without vehicle access beyond 1 mile from a supermarket (as represented by the predictor variable "Vehicle Access.1 Mile") and the percentage of tract population residing in group quarters (as represented by the response variable "group_quarters").

```{r}

#| label: x

summary(food_access[,c("Population", "group_quarters", "Housing Data.Total Housing Units", "Vehicle Access.1 Mile")])

# Check for missing values
sum(is.na(food_access))

ggplot(food_access, aes(x= group_quarters)) +
  geom_histogram(binwidth=10, fill="blue", color="white") +
  labs(title="Distribution of population residing in group quarters", x="Population in group quarters", y="Frequency")

ggplot(food_access, aes(x=`Vehicle Access.1 Mile`, y= group_quarters)) +
  geom_point() +
  labs(title="Scatterplot of vehicle access beyond 1 mile against population in group quarters", x="Vehicle Access.1 Mile", y="Population in group quarters")

```

```{r}

#| label: linear regression

food_access_DC <- food_access |>
  filter(State == "District of Columbia")

linear_reg() |>
  set_engine("lm") |>
  fit(`Low Access Numbers.Low Income People.10 Miles` ~ `Vehicle Access.10 Miles` + `Low Access Numbers.Seniors.1 Mile`, data = food_access_DC) |>
  tidy()

```

```{r}

#| label: pulling R Squared

food_access_ND <- food_access |>
  filter(State == "North Dakota")

model_ND <- linear_reg() |>
  set_engine("lm") |>
  fit(`Low Access Numbers.Low Income People.10 Miles` ~ `Vehicle Access.10 Miles` + `Low Access Numbers.Seniors.10 Miles`, data = food_access_reg) 

model_ND |>
  glance() |>
  pull(adj.r.squared)

```

REALLY GOOD MODEL, has high adjusted r squared value,

us

\*We choose a hypothesis test because it helps answer our research question if the Northwest or Northeast is more impacted by being low income and living 10 miles away from a supermarket. We hypothesize that compared to the Northeast, the Midwest will be mostly impacted by having a greater proportion of low income population count beyond 10 miles from supermarket. Our null hypothesis is the true mean proportional difference for low income and beyond 10 miles from the supermarket between the Midwest and northeast is equal to 0. Our alternate is the true mean proportional difference for low income and beyond 10 miles from the supermarket between the Midwest and northeast is greater than 0. Using the resulting p-values from our test, we can see if the Midwest is more impacted or if there is no difference between the two. We will be using simulation based techniques. We will permute all observations together, distribute them into two new groups, calculate the new sample means for each group, and lastly subtract the new sample means. This will be done 5000 times.

WRITE IN PROPER NOTATION

$H_o$ = the true mean proportional difference for low income and beyond 10 miles from the supermarket between the Midwest and northeast is equal to 0

$H_a$ = The true mean proportional difference for low income and beyond 10 miles from the supermarket between the Midwest and northeast is greater than 0

```{r}

#| label: mean for Midwest and Northeast

food_access_reg |>
  filter (region == "Midwest") |>
  summarize (mean = mean(proportion))

food_access_reg |>
  filter (region == "Northeast") |>
  summarize (mean = mean(proportion))

xbar <- 0.1124311 - 0.01673986

xbar

```

The sample mean proportion of low income population count beyond 10 miles from the supermarket is .11 for the Midwest region and .017 for the Northeast region.

$\bar{x_{Midwest}} = .11$ $\bar {x_{Northeast}} = .017$

The true sample proportion of low income population count beyond 10 miles from the supermarket is .11 for the Midwest region and .017 for the Northeast region. $\bar{x_{Midwest}} = 0.1124311$ $\bar {x_{Northeast}} = .017$

The true mean proportion of low income population count beyond 10 miles from the supermarket is .11 for the Midwest region and .017 for the Northeast region. $\bar{x_{Midwest}} = 0.1124311$ $\bar {x_{Northeast}} = .017$

```{r}

#| label: visualiation

null_dist <- food_access_reg |>
  filter (region %in% c("Midwest", "Northeast")) |>
  specify (response = proportion, explanatory = region) |>
  hypothesize (null = "independence") |>
  generate (reps = 5000, type = "permute") |>
  calculate (stat = "diff in means", order = c("Midwest", "Northeast"))

```

```{r}

null_dist |>
  ggplot(
    aes(x = stat)) + 
  geom_histogram() +
  geom_vline(xintercept = 0.09569124)

```

```{r}

null_dist |>
  get_p_value(obs_stat = xbar, direction = "greater")

```

Conclusion: The probability of observing a difference of 0.09569124 between the mean proportion of the Midwest versus the Northeast and low income population count beyond 10 miles from the supermarket is equal to 0, given that the difference is equal to 0, is p = \~0. Because p = \~ 0 alpha = .05, we reject the null hypothesis that the true mean proportional difference between the Midwest and low income population count beyond 10 miles from the supermarket is equal to 0. We have strong evidence to conclude the alternate.

Conclusion: The probability of observing a difference of 0.09569124 between the mean proportion of the Midwest versus the Northeast and low income population count beyond 10 miles from the supermarket is equal to 0, given that the true mean proportional difference for low income and beyond 10 miles from the supermarket between the Midwest and northeast is equal to 0 the difference is equal to 0. Because p = \~ 0 alpha = .05, we reject the null hypothesis. We have strong evidence to conclude the alternate. Based on this test, we can answer our research question and say that the Midwest is more impacted than the Northeast for low income and being beyond 10 miles from a supermarket.

Conclusion: The probability of observing a difference of 0.09569124 between the mean proportion of the Midwest versus the Northeast and low income population count beyond 10 miles from the supermarket is equal to 0, given that the difference is equal to 0, is p = \~0. Because p = 0 $alpha$ = .05, we reject the null hypothesis that the true mean proportional difference between the Midwest and low income population count beyond 10 miles from the supermarket is equal to 0. We have strong evidence to conclude the alternate.

**Confidence Interval: True mean proportion for Midwest**

After our result from the hypothesis test, we wanted to further support that the Midwest is more impacted than the Northeast. Therefore, we will be creating two confidence intervals to determine the true mean proportion for low income and living 10 miles beyond a supermarkets. We will compare those intervals. The interval with a higher proportion interval will be the most impacted by being low income and living 10 miles beyond a supermarket. We will be used simulation based techniques because we are sampling with replacement, calculating the new re-sampled mean, then we will be repeat that process 5000 times.

```{r}

set.seed(12345)

boot_df <- food_access_reg |>
  filter (region == "Midwest") |>
  specify(response = proportion) |>
  generate(reps = 5000, type = "bootstrap") |>
  calculate(stat = "mean")

glimpse(boot_df)

```

```{r}

set.seed(12345)
boot_df |>
  summarize(lower = quantile(stat, 0.025),
            upper = quantile(stat, 0.975))

```

We are creating a histogram to see the distribution of resamples from our original data for Northwest. We also have lines that represent our confidence interval.

```{r}

boot_df |>
  ggplot(
    aes(x = stat)) + 
  geom_histogram() + 
  geom_vline(xintercept = c(0.102609 , 0.1226445)) + 
  labs(title = "95% Confidence Interval",
       subtitle = "True mean price per guest")

```

Interpretation: We are 95% confident that the true mean proportion of low income individuals that live beyond 10 miles from a supermarket in the Midwest is between 0.102609 and 0.1226445.

**Confidence Interval: True mean proportion for Northeast**

```{r}

set.seed(12345)

boot_df <- food_access_reg |>
  filter (region == "Northeast") |>
  specify(response = proportion) |>
  generate(reps = 5000, type = "bootstrap") |>
  calculate(stat = "mean")

glimpse(boot_df)

```

```{r}

set.seed(12345)
boot_df |>
  summarize(lower = quantile(stat, 0.025),
            upper = quantile(stat, 0.975))

```

We are creating a histogram to see the distribution of re-samples from our original data for Northeast. We also have lines that represent our confidence interval.

```{r}

boot_df |>
  ggplot(
    aes(x = stat)) + 
  geom_histogram() + 
  geom_vline(xintercept = c(0.102609 , 0.1226445)) + 
  labs(title = "95% Confidence Interval",
       subtitle = "True mean price per guest")

```

Interpretation: We are 95% confident that the true mean proportion of low income individuals that live beyond 10 miles from a supermarket in the Northeast is between 0.01155406 and 0.02294395.

```{r}

#| label: relationship between low income and vehicle access in the Midwest & Northeast

food_access_reg |>
  filter (region %in% c ("Midwest", "Northeast")) |>
  ggplot (aes (x = proportion_vehicle, y = proportion)) +
  geom_point() + 
  facet_wrap ("region", ncol = 1)

```

We wanted to see if having no vehicle access and being beyond 10 miles from a market contributes to low income and being 10 miles from a market. Therefore, we created a scatter plot. There is a positive relationship between the proportion of having no vehicle and being beyond 10 miles away from a market and the proportion of low income who are 10 miles away from a supermarket for both regions. As the proportion of no vehicle access who are 10 miles away increases so does the proportion for individuals who are low income and are 10 miles away from a market.

Sathvika add to results: These two graphs support our claim that Midwest is more impacted as the proportions for the Midwest reach higher numbers for the proportion of low income who are 10 miles away. Moreover, it shows that having no vehicle access contributes to this problem, supporting our claim that Midwest is more impacted by not have reliable access to transportation compared to more urban areas like the Northeast.

```{r}

#| label: relationship between low income and seniors in the Midwest & Northeast

food_access_reg |>
  filter (region %in% c ("Midwest", "Northeast")) |>
  ggplot (aes (x = proportion_seniors, y = proportion)) +
  geom_point() + 
  facet_wrap ("region", ncol = 1)

```

We wanted to see if being a senior who was beyond 10 miles from a market contributes to low income and being 10 miles from a market. Therefore, we created a scatter plot. There is a positive relationship between the proportion of being a senior and living 10 miles away from a market and the proportion of low income who are 10 miles away from a supermarket for both regions. As the proportion of being a senior and living 10 miles away increases so does the proportion for individuals who are low income and are 10 miles away from a market.

## Results

## Discussion

**ADD SUMMARY\***

The analysis included the state with the most no vehicle access which was District of Columbia. However, the District of Columbia has only one row of collected data, therefore, we could not perform an accurate linear regression in order to quantify the relationship between the variables contributing to the no vehicle access and low income. This could be a limitation of the analysis and therefore combining more data from other datasets would help strengthen this analysis more. Not much could be analyzed from housing quarters and no vehicle access, and more could be gleamed from combining other data sets. There could be more influential variables affecting the low access, low income people living 10 miles away, however only much could be done using this data set.

Also, since this dataset was collected by census and surveys, there could be a sample size and representation bias. Surveys often rely on a sample of people to represent a larger population. If the sample size is too small or not representative of the population of interest, the results may not be generalizable to the broader population.

Some potential areas of future interest include: relationship between food access and health outcomes, or socioeconomic factors. With the data on health outcomes available in the dataset, researchers could explore whether living in an area with limited food access is associated with poorer health outcomes, such as higher rates of obesity, diabetes, or heart disease. The dataset could expand to include information on income, education level, and race/ethnicity. Researchers could explore whether these factors are associated with differences in food access, and if so, what policy interventions might be effective in addressing these disparities.

\
